<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- Swiper CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
  
  <!-- Your stylesheet -->
  <link rel="stylesheet" href="style.css" />
  
  <!-- Pixi.js (if you need it) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.2.4/pixi.min.js"></script>
  
  <title>Portafolio</title>
</head>
<body>
  <!-- Your existing canvas, blur layer, etc. -->
  <canvas id="canvas1"></canvas>
  <div class="blur-layer"></div>

  <!-- =========================
       HEADER & NAVIGATION
       ========================= -->
  <section class="header-section">
    <div class="personal-photo"></div>
    <div class="header-content">
      <div class="icon-buttons">
        <div class="navigation-buttons">
          <div class="icon-button">
            <img src="./Slider/Recursos/Proyectos.svg" alt="Projects" />
            <span>Projects</span>
          </div>
          <div class="icon-button">
            <img src="./Slider/Recursos/About me.svg" alt="About Me" />
            <span>About Me</span>
          </div>
          <div class="icon-button">
            <img src="./Slider/Recursos/contact.svg" alt="Contact" />
            <span>Contact</span>
          </div>
        </div>
        <div class="icon-button">
          <img src="./Slider/Recursos/Lighbulb.svg" alt="Lightbulb" />
        </div>
      </div>
    </div>
  </section>

  <!-- =========================
       SWIPER CONTAINER
       ========================= -->
  <div class="boolean-container">
    <div class="swiper">
      <div class="swiper-wrapper">
        <!-- Slide 1 -->
        <div class="swiper-slide" data-hover>
          <!-- The magnetically hovered area can be inside data-hover-bounds -->
          <div data-hover-bounds class="image-container static-img">
            <img
              src="./Slider/Recursos/Kinetic rush-static.webp"
              alt="Static Image 1"
              class="imagen-contenida"
            />
            <div class="grid">
              <div class="grid-collumn"></div>
              <div class="grid-collumn"></div>
              <div class="grid-collumn"></div>
              <div class="grid-collumn"></div>
            </div>
          </div>
          <img
            src="./Slider/Recursos/Kinetic rush-active.gif"
            alt="Active GIF 1"
            class="active-gif"
          />
          <div class="title">
            <span>Nombre del proyecto</span>
          </div>
          <div class="subtitle">
            <span>Subtítulo del proyecto</span>
          </div>
          <div class="blur"></div>
        </div>

        <!-- Slide 2 -->
        <div class="swiper-slide" data-hover>
          <div data-hover-bounds class="image-container static-img">
            <img
              src="./Slider/Recursos/Control-static.webp"
              alt="Static Image 2"
              class="imagen-contenida"
            />
            <div class="grid">
              <div class="grid-collumn"></div>
              <div class="grid-collumn"></div>
              <div class="grid-collumn"></div>
              <div class="grid-collumn"></div>
            </div>
          </div>
          <img
            src="./Slider/Recursos/Control-active.gif"
            alt="Active GIF 2"
            class="active-gif"
          />
          <div class="title">
            <span>Nombre del proyecto</span>
          </div>
          <div class="subtitle">
            <span>Subtítulo del proyecto</span>
          </div>
          <div class="blur"></div>
        </div>

        <!-- Slide 3 -->
        <div class="swiper-slide" data-hover>
          <div data-hover-bounds class="image-container static-img">
            <img
              src="./Slider/Recursos/Portada.webp"
              alt="Static Image 3"
              class="imagen-contenida"
            />
            <div class="grid">
              <div class="grid-collumn"></div>
              <div class="grid-collumn"></div>
              <div class="grid-collumn"></div>
              <div class="grid-collumn"></div>
            </div>
          </div>
          <img
            src="./Slider/Recursos/AvalPay-Active.gif"
            alt="Active GIF 3"
            class="active-gif"
          />
          <div class="title">
            <span>Nombre del proyecto</span>
          </div>
          <div class="subtitle">
            <span>Subtítulo del proyecto</span>
          </div>
          <div class="blur"></div>
        </div>

        <!-- Slide 4 -->
        <div class="swiper-slide" data-hover>
          <div data-hover-bounds class="image-container static-img">
            <img
              src="./Slider/Recursos/Duraznos intro.gif"
              alt="Static Image 3"
              class="imagen-contenida"
            />
            <div class="grid">
              <div class="grid-collumn"></div>
              <div class="grid-collumn"></div>
              <div class="grid-collumn"></div>
              <div class="grid-collumn"></div>
            </div>
          </div>
          <img
            src="./Slider/Recursos/Duraznos active.gif"
            alt="Active GIF 3"
            class="active-gif"
          />
          <div class="title">
            <span>Nombre del proyecto</span>
          </div>
          <div class="subtitle">
            <span>Subtítulo del proyecto</span>
          </div>
          <div class="blur"></div>
        </div>

        <!-- Slide 5 -->
        <div class="swiper-slide" data-hover>
          <div data-hover-bounds class="image-container static-img">
            <img
              src="./Slider/Recursos/CR.webp"
              alt="Static Image 4"
              class="imagen-contenida"
            />
            <div class="grid">
              <div class="grid-collumn"></div>
              <div class="grid-collumn"></div>
              <div class="grid-collumn"></div>
              <div class="grid-collumn"></div>
            </div>
          </div>
          <img
            src="./Slider/Recursos/AvalPay-Active.gif"
            alt="Active GIF 4"
            class="active-gif"
          />
          <div class="title">
            <span>Nombre del proyecto</span>
          </div>
          <div class="subtitle">
            <span>Subtítulo del proyecto</span>
          </div>
          <div class="blur"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- =========================
       SWIPER CONTROLS
       ========================= -->
  <div class="control-container">
    <div class="swiper-button-container">
      <div class="swiper-button-prev">
        <img
          src="./Slider/Recursos/arrow-left.svg"
          alt="Previous"
          class="new-icon"
        />
      </div>
      <div class="swiper-button-next">
        <img
          src="./Slider/Recursos/arrow-right.svg"
          alt="Next"
          class="new-icon"
        />
      </div>
    </div>
    <!-- Pagination -->
    <div class="pagination-container">
      <div class="swiper-pagination"></div>
      <!-- <button class="next-project-btn">Open project</button> -->
    </div>
  </div>

  <div class="swiper-scrollbar"></div>

  <!-- =========================
       ABOUT / TITLE SECTION
       ========================= -->
  <section class="tittle-section">
    <div class="tittle-content">
      <div class="main-text masked-element">
        <h2 class="main-subtitle">
          <span id="nombreI"></span>
        </h2>
        <h1 class="main-title">David López</h1>
      </div>
    </div>
    <div class="about-me-compliment">
      <img src="./Slider/Recursos/Museum.webp" alt="" />
    </div>
  </section>

  <!-- =========================
       CUSTOM "CUBERTO-LIKE" CURSOR
       ========================= -->
  <div class="cursor"></div>

  <!-- =========================
       SCRIPTS
       ========================= -->

  <!-- Swiper JS -->
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

  <!-- GSAP core & ScrollTrigger -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

  <!-- Main script (ES module) -->
  <script type="module">
    import { vec2 } from "https://esm.sh/vecteur";

    /**
     * A "Cuberto-like" Magnetic Cursor
     */
    class MagneticCursor {
      constructor(domEl) {
        this.el = domEl;

        // Positions (vec2) for smooth movement
        this.position = {
          previous: vec2(-100, -100),
          current: vec2(-100, -100),
          target: vec2(-100, -100),
          lerpAmount: 0.1, // how quickly the cursor “catches up”
        };

        // Scale states to enlarge when hovered
        this.scale = {
          previous: 1,
          current: 1,
          target: 1,
          lerpAmount: 0.1,
        };

        this.isHovered = false;
        this.hoverEl = null;

        this.addListeners();
      }

      // Called every frame via gsap.ticker
      update() {
        // Lerp positions
        this.position.current.lerp(this.position.target, this.position.lerpAmount);
        // Lerp scale
        this.scale.current = gsap.utils.interpolate(
          this.scale.current,
          this.scale.target,
          this.scale.lerpAmount
        );

        // Compute velocity (delta)
        const delta = this.position.current.clone().sub(this.position.previous);

        // Copy current => previous for next frame
        this.position.previous.copy(this.position.current);
        this.scale.previous = this.scale.current;

        // Move DOM element
        gsap.set(this.el, {
          x: this.position.current.x,
          y: this.position.current.y,
        });

        // If NOT hovered, distort the circle based on velocity
        if (!this.isHovered) {
          const angle = Math.atan2(delta.y, delta.x) * (180 / Math.PI);
          const speed = delta.length() * 0.04; // used to distort scale

          gsap.set(this.el, {
            rotate: angle,
            scaleX: this.scale.current + Math.min(speed, 1),
            scaleY: this.scale.current - Math.min(speed, 0.3),
          });
        }
      }

      // Update the "target" position
      // If hovered => pull near center of hovered element
      updateTargetPosition(x, y) {
        if (this.isHovered && this.hoverEl) {
          const bounds = this.hoverEl.getBoundingClientRect();
          const cx = bounds.x + bounds.width / 2;
          const cy = bounds.y + bounds.height / 2;

          const dx = x - cx;
          const dy = y - cy;

          // Cursor is pulled to the center by 15%
          this.position.target.x = cx + dx * 0.15;
          this.position.target.y = cy + dy * 0.15;

          // Enlarge cursor
          this.scale.target = 2;

          // Also rotate the cursor a bit
          const angle = Math.atan2(dy, dx) * (180 / Math.PI);
          const distance = Math.sqrt(dx * dx + dy * dy) * 0.01;
          gsap.set(this.el, { rotate: angle });
          gsap.to(this.el, {
            scaleX: this.scale.target + Math.pow(Math.min(distance, 0.6), 3) * 3,
            scaleY: this.scale.target - Math.pow(Math.min(distance, 0.3), 3) * 3,
            duration: 0.5,
            ease: "power4.out",
            overwrite: true,
          });
        } else {
          // Normal mode: follow the pointer exactly
          this.position.target.x = x;
          this.position.target.y = y;
          this.scale.target = 1;
        }
      }

      // Listen for pointerover, pointerout on any [data-hover] elements
      addListeners() {
        gsap.utils.toArray("[data-hover]").forEach((parentEl) => {
          // Child element that defines the "hover area"
          const hoverBoundsEl = parentEl.querySelector("[data-hover-bounds]");
          if (!hoverBoundsEl) return;

          // On pointerover => hover
          hoverBoundsEl.addEventListener("pointerover", () => {
            this.isHovered = true;
            this.hoverEl = hoverBoundsEl;
          });
          // On pointerout => no hover
          hoverBoundsEl.addEventListener("pointerout", () => {
            this.isHovered = false;
            this.hoverEl = null;
          });

          // ------------------------------
          // Magnetic effect on the element itself
          // ------------------------------
          // Moves the parentEl slightly using GSAP QuickSetter
          const xSetter = gsap.quickTo(parentEl, "x", {
            duration: 1,
            ease: "elastic.out(1, 0.3)",
          });
          const ySetter = gsap.quickTo(parentEl, "y", {
            duration: 1,
            ease: "elastic.out(1, 0.3)",
          });

          hoverBoundsEl.addEventListener("pointermove", (ev) => {
            const { clientX, clientY } = ev;
            const rect = parentEl.getBoundingClientRect();
            const rx = clientX - (rect.left + rect.width / 2);
            const ry = clientY - (rect.top + rect.height / 2);

            // Move the element (20%) toward pointer
            xSetter(rx * 0.2);
            ySetter(ry * 0.2);
          });

          hoverBoundsEl.addEventListener("pointerout", () => {
            // Reset element’s position
            xSetter(0);
            ySetter(0);
          });
        });
      }
    }

    // =========================
    // ON DOM READY
    // =========================
    document.addEventListener("DOMContentLoaded", () => {
      // 1) Initialize our custom cursor
      const cursorEl = document.querySelector(".cursor");
      const myCursor = new MagneticCursor(cursorEl);

      // Animate cursor every GSAP frame
      gsap.ticker.add(() => myCursor.update());

      // Update cursor target position on pointer move
      window.addEventListener("pointermove", (e) => {
        myCursor.updateTargetPosition(e.clientX, e.clientY);
      });

      // 2) Initialize Swiper (example config)
      const swiper = new Swiper(".swiper", {
        loop: true,
        pagination: {
          el: ".swiper-pagination",
          clickable: true,
        },
        navigation: {
          nextEl: ".swiper-button-next",
          prevEl: ".swiper-button-prev",
        },
        scrollbar: {
          el: ".swiper-scrollbar",
        },
      });
    });
  </script>
</body>
</html>
